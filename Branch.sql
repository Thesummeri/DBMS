create database branches;
use branches;
CREATE TABLE BRANCH (Branchid int primary key, Branchname char (15), HOD char (15));
INSERT INTO BRANCH VALUES (1, 'MCA','Dr. RAJU');
INSERT INTO BRANCH VALUES (2, 'CS','Prof.PRAVEEN');
INSERT INTO BRANCH VALUES (3, 'EC','Dr. KRUPA R');
INSERT INTO BRANCH VALUES (4, 'MCA','Dr. KSN');
INSERT INTO BRANCH VALUES (5, 'CV','Prof. Raj');
SELECT *FROM BRANCH;

CREATE TABLE STUDENT(USN VARCHAR(10) PRIMARY KEY,Name char(15), Address varchar(15),Branchid int,sem int,foreign key(Branchid) references BRANCH(Branchid));
INSERT INTO STUDENT VALUES('2JI20MC001', 'AKASH','KHANAPUR',1,2);
INSERT INTO STUDENT VALUES('2JI20MC002', 'VINAY','BELAGAVI',4,2);
INSERT INTO STUDENT VALUES('2JI20CS005', 'VIRAT','MUMBAI',2,6);
INSERT INTO STUDENT VALUES('2JI20CV045', 'RAHUL','PUNE',5,7);
INSERT INTO STUDENT VALUES('2JI19MC003','RAVI','HUBBALI',2,6);
SELECT * FROM STUDENT;

CREATE TABLE AUTHOR(Authorid int primary key,Authorname char(15),Country char(10),age int);
INSERT INTO AUTHOR VALUES(444,'RAMKRISHNAN','INDIA',56);
INSERT INTO AUTHOR VALUES(555,'ELMASRI','US',75);
INSERT INTO AUTHOR VALUES(666,'HERBERT','CANADA',60);
INSERT INTO AUTHOR VALUES(777,'KOTUR','INDIA',58);
SELECT * FROM AUTHOR;

CREATE TABLE BOOK(Bookid varchar(5) primary key,Bookname char(15),Authorid int,Publisher char(15),Branchid int,foreign key(Authorid) references AUTHOR(Authorid),foreign key(Branchid) references BRANCH(Branchid));
INSERT INTO BOOK VALUES('B01','JAVA',666,'TATA MCGRAW',1);
INSERT INTO BOOK VALUES('B02','DBMC',555,'TATA MCGRAW',1);
INSERT INTO BOOK VALUES('B03','DBMS',555,'TATA MCGRAW',2);
INSERT INTO BOOK VALUES('B04','C++',777,'PH',4);
INSERT INTO BOOK VALUES('B05','CONSTRUCT',444,'PH',5);
SELECT * FROM BOOK;

CREATE TABLE BOROW (USN VARCHAR(10),Bookid varchar(5),Borrow_date date, foreign key(USN) references STUDENT(USN),foreign key(Bookid) references BOOK(Bookid));
INSERT INTO BOROW VALUES('2JI20MC001','B01','2021-01-31');
INSERT INTO BOROW VALUES('2JI20MC001','B02','2021-01-30');
INSERT INTO BOROW VALUES('2JI20MC002','B03','2020-02-05');
INSERT INTO BOROW VALUES('2JI20CV045','B04','2019-12-22');
INSERT INTO BOROW VALUES('2JI20CS005','B05','2019-10-12');
INSERT INTO BOROW VALUES('2JI20MC001','B05','2020-07-20');
SELECT * FROM BOROW;

SELECT *FROM STUDENT S, BRANCH B WHERE S.Branchid=B.Branchid AND S.sem = 2 AND B.Branchname = 'MCA';

SELECT * FROM STUDENT S WHERE S.USN NOT IN (SELECT B.USN FROM BOROW B);

SELECT S.USN, S.NAME,BR.Branchname,BK.Bookname,A.Authorname, BW.Borrow_date FROM STUDENT S, BRANCH BR,BOOK BK, AUTHOR A, BOROW BW WHERE S.Branchid= BR.Branchid AND S.Branchid = BK.Branchid AND A.Authorid = BK.Authorid AND BW.USN = S.USN AND BK.Bookid = BW.Bookid AND S.sem = 2 AND BR.Branchname = 'MCA';

SELECT * FROM AUTHOR; 
SELECT * FROM BOOK;

SELECT A.Authorid, A.Authorname, count(DISTINCT BK.Bookid) as No_of_Books FROM AUTHOR A, BOOK BK WHERE A.Authorid= BK.Authorid GROUP BY A.Authorid,A.Authorname;

SELECT S.USN, S.NAME FROM STUDENT S, BOROW BW WHERE S.USN = BW.USN GROUP BY S.USN, S.NAME HAVING COUNT(BW.BOOKID)>2;

SELECT S.USN, S.NAME FROM STUDENT S, BOROW BW WHERE S.USN = BW.USN GROUP BY S.USN, S.NAME HAVING COUNT(BW.BOOKID)>2;

SELECT BOOKNAME FROM BOOK ORDER BY Bookname DESC;

SELECT S.USN, S.NAME, COUNT(BK.PUBLISHER) AS SAME_PUBLISHER FROM STUDENT S, BOOK BK, BOROW BW WHERE S.USN=BW.USN AND BK.Bookid = BW.Bookid GROUP BY S.USN, S.NAME HAVING COUNT(BK.Publisher)>1;

